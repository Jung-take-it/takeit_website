<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>êµê³¼ëª© í‰ê·  ê°•ì˜ì‹œê°„ ì•ˆë‚´ ì„œë¹„ìŠ¤</title>
  <style>
    body {
      font-family: 'Arial';
      background: #f5f7fa;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    header {
      background: #34495e;
      color: white;
      padding: 1.5em;
      font-size: 1.8em;
    }
    main {
      padding: 2em;
    }
    a.button {
      text-decoration: none;
      background: #3498db;
      color: white;
      padding: 0.6em 1.5em;
      border-radius: 10px;
      display: inline-block;
      margin: 0.5em 0;
    }
    .card {
      background: white;
      max-width: 500px;
      margin: 1em auto;
      padding: 1em;
      border-radius: 10px;
      box-shadow: 0 3px 10px rgba(0,0,0,0.1);
    }
  </style>
</head>
<body>
  <header>êµê³¼ëª© í‰ê·  ê°•ì˜ì‹œê°„ ì•ˆë‚´ ì„œë¹„ìŠ¤</header>
  <main>
    <a class="button" href="summary.html">ì„œë¹„ìŠ¤ ìš”ì•½</a><br>
    <a class="button" href="project/detail.html">ê°œì¸ í”„ë¡œì íŠ¸</a><br>
    <a class="button" href="feedback.html">í”¼ë“œë°± ì…ë ¥</a><br>
    <a class="button" href="chart.html">ê°•ì˜ ì¢…ë£Œ ì‹œê° í†µê³„</a><br><br>

    <h2>ğŸ“Š í•™ê³¼ë³„ í‰ê·  ì¢…ë£Œ ì‹œê°</h2>
    <div id="department-stats">ë¡œë”© ì¤‘...</div>
  </main>

  <script>
    const apiUrl = "https://script.google.com/macros/s/AKfycbw6Vq59qX878Mp8AWVkR_zlDEIUv5KEz8mB27uQqd8SL5_L4rZ-2Iyagnmxy0u94SWQ/exec";
    fetch(apiUrl)
      .then(res => res.json())
      .then(data => {
        const deptTimes = {};

        data.forEach(entry => {
          const dept = entry.í•™ê³¼ëª… || entry.department;
          const time = entry.ìˆ˜ì—…ì¢…ë£Œì‹œê°„ || entry.endtime;
          if (!dept || !time || !time.includes(":")) return;

          const [hh, mm] = time.split(":").map(Number);
          const totalMin = hh * 60 + mm;

          if (!deptTimes[dept]) deptTimes[dept] = [];
          deptTimes[dept].push(totalMin);
        });

        const container = document.getElementById("department-stats");
        container.innerHTML = "";

        Object.entries(deptTimes).forEach(([dept, times]) => {
          const avg = Math.round(times.reduce((a, b) => a + b, 0) / times.length);
          const hour = String(Math.floor(avg / 60)).padStart(2, "0");
          const min = String(avg % 60).padStart(2, "0");

          const card = document.createElement("div");
          card.className = "card";
          card.innerHTML = `<strong>${dept}</strong><br>í‰ê·  ì¢…ë£Œ ì‹œê°: <em>${hour}:${min}</em>`;
          container.appendChild(card);
        });
      })
      .catch(err => {
        document.getElementById("department-stats").innerText = "ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
      });
  </script>
</body>
</html>
